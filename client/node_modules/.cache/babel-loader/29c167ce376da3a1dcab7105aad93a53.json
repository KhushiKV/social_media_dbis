{"ast":null,"code":"'use strict';\n\nvar _slicedToArray = function () {\n  function sliceIterator(arr, i) {\n    var _arr = [];\n    var _n = true;\n    var _d = false;\n    var _e = undefined;\n\n    try {\n      for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n        _arr.push(_s.value);\n\n        if (i && _arr.length === i) break;\n      }\n    } catch (err) {\n      _d = true;\n      _e = err;\n    } finally {\n      try {\n        if (!_n && _i[\"return\"]) _i[\"return\"]();\n      } finally {\n        if (_d) throw _e;\n      }\n    }\n\n    return _arr;\n  }\n\n  return function (arr, i) {\n    if (Array.isArray(arr)) {\n      return arr;\n    } else if (Symbol.iterator in Object(arr)) {\n      return sliceIterator(arr, i);\n    } else {\n      throw new TypeError(\"Invalid attempt to destructure non-iterable instance\");\n    }\n  };\n}();\n\nvar _extends = Object.assign || function (target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i];\n\n    for (var key in source) {\n      if (Object.prototype.hasOwnProperty.call(source, key)) {\n        target[key] = source[key];\n      }\n    }\n  }\n\n  return target;\n};\n\nvar _createClass = function () {\n  function defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  return function (Constructor, protoProps, staticProps) {\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) defineProperties(Constructor, staticProps);\n    return Constructor;\n  };\n}();\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (!self) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\n}\n\nvar fs = require('fs');\n\nvar _require = require('path'),\n    extname = _require.extname,\n    basename = _require.basename;\n\nvar Q = require('q');\n\nvar Writable = require(\"stream\").Writable;\n\nvar urlLib = require('url'); // eslint-disable-next-line import/order\n\n\nvar _require2 = require(\"./config\")(),\n    upload_prefix = _require2.upload_prefix;\n\nvar isSecure = !(upload_prefix && upload_prefix.slice(0, 5) === 'http:');\nvar https = isSecure ? require('https') : require('http');\n\nvar Cache = require('./cache');\n\nvar utils = require(\"./utils\");\n\nvar UploadStream = require('./upload_stream');\n\nvar config = require(\"./config\");\n\nvar ProxyAgent = utils.optionalRequire('proxy-agent');\n\nvar ensureOption = require('./utils/ensureOption').defaults(config());\n\nvar build_upload_params = utils.build_upload_params,\n    extend = utils.extend,\n    includes = utils.includes,\n    isEmpty = utils.isEmpty,\n    isObject = utils.isObject,\n    isRemoteUrl = utils.isRemoteUrl,\n    merge = utils.merge,\n    pickOnlyExistingValues = utils.pickOnlyExistingValues;\n\nexports.unsigned_upload_stream = function unsigned_upload_stream(upload_preset, callback) {\n  var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  return exports.upload_stream(callback, merge(options, {\n    unsigned: true,\n    upload_preset: upload_preset\n  }));\n};\n\nexports.upload_stream = function upload_stream(callback) {\n  var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  return exports.upload(null, callback, extend({\n    stream: true\n  }, options));\n};\n\nexports.unsigned_upload = function unsigned_upload(file, upload_preset, callback) {\n  var options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n  return exports.upload(file, callback, merge(options, {\n    unsigned: true,\n    upload_preset: upload_preset\n  }));\n};\n\nexports.upload = function upload(file, callback) {\n  var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  return call_api(\"upload\", callback, options, function () {\n    var params = build_upload_params(options);\n    return isRemoteUrl(file) ? [params, {\n      file: file\n    }] : [params, {}, file];\n  });\n};\n\nexports.upload_large = function upload_large(path, callback) {\n  var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n  if (path != null && isRemoteUrl(path)) {\n    // upload a remote file\n    return exports.upload(path, callback, options);\n  }\n\n  if (path != null && !options.filename) {\n    options.filename = path.split(/(\\\\|\\/)/g).pop().replace(/\\.[^/.]+$/, \"\");\n  }\n\n  return exports.upload_chunked(path, callback, extend({\n    resource_type: 'raw'\n  }, options));\n};\n\nexports.upload_chunked = function upload_chunked(path, callback, options) {\n  var file_reader = fs.createReadStream(path);\n  var out_stream = exports.upload_chunked_stream(callback, options);\n  return file_reader.pipe(out_stream);\n};\n\nvar Chunkable = function (_Writable) {\n  _inherits(Chunkable, _Writable);\n\n  function Chunkable(options) {\n    _classCallCheck(this, Chunkable);\n\n    var _this = _possibleConstructorReturn(this, (Chunkable.__proto__ || Object.getPrototypeOf(Chunkable)).call(this, options));\n\n    _this.chunk_size = options.chunk_size != null ? options.chunk_size : 20000000;\n    _this.buffer = Buffer.alloc(0);\n    _this.active = true;\n\n    _this.on('finish', function () {\n      if (_this.active) {\n        _this.emit('ready', _this.buffer, true, function () {});\n      }\n    });\n\n    return _this;\n  }\n\n  _createClass(Chunkable, [{\n    key: '_write',\n    value: function _write(data, encoding, done) {\n      var _this2 = this;\n\n      if (!this.active) {\n        done();\n      }\n\n      if (this.buffer.length + data.length <= this.chunk_size) {\n        this.buffer = Buffer.concat([this.buffer, data], this.buffer.length + data.length);\n        done();\n      } else {\n        var grab = this.chunk_size - this.buffer.length;\n        this.buffer = Buffer.concat([this.buffer, data.slice(0, grab)], this.buffer.length + grab);\n        this.emit('ready', this.buffer, false, function (active) {\n          _this2.active = active;\n\n          if (_this2.active) {\n            _this2.buffer = data.slice(grab);\n            done();\n          }\n        });\n      }\n    }\n  }]);\n\n  return Chunkable;\n}(Writable);\n\nexports.upload_large_stream = function upload_large_stream(_unused_, callback) {\n  var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  return exports.upload_chunked_stream(callback, extend({\n    resource_type: 'raw'\n  }, options));\n};\n\nexports.upload_chunked_stream = function upload_chunked_stream(callback) {\n  var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  options = extend({}, options, {\n    stream: true\n  });\n  options.x_unique_upload_id = utils.random_public_id();\n  var params = build_upload_params(options);\n  var chunk_size = options.chunk_size != null ? options.chunk_size : options.part_size;\n  var chunker = new Chunkable({\n    chunk_size: chunk_size\n  });\n  var sent = 0;\n  chunker.on('ready', function (buffer, is_last, done) {\n    var chunk_start = sent;\n    sent += buffer.length;\n    options.content_range = `bytes ${chunk_start}-${sent - 1}/${is_last ? sent : -1}`;\n    params.timestamp = utils.timestamp();\n\n    var finished_part = function finished_part(result) {\n      var errorOrLast = result.error != null || is_last;\n\n      if (errorOrLast && typeof callback === \"function\") {\n        callback(result);\n      }\n\n      return done(!errorOrLast);\n    };\n\n    var stream = call_api(\"upload\", finished_part, options, function () {\n      return [params, {}, buffer];\n    });\n    return stream.write(buffer, 'buffer', function () {\n      return stream.end();\n    });\n  });\n  return chunker;\n};\n\nexports.explicit = function explicit(public_id, callback) {\n  var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  return call_api(\"explicit\", callback, options, function () {\n    return utils.build_explicit_api_params(public_id, options);\n  });\n}; // Creates a new archive in the server and returns information in JSON format\n\n\nexports.create_archive = function create_archive(callback) {\n  var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  var target_format = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n  return call_api(\"generate_archive\", callback, options, function () {\n    var opt = utils.archive_params(options);\n\n    if (target_format) {\n      opt.target_format = target_format;\n    }\n\n    return [opt];\n  });\n}; // Creates a new zip archive in the server and returns information in JSON format\n\n\nexports.create_zip = function create_zip(callback) {\n  var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  return exports.create_archive(callback, options, \"zip\");\n};\n\nexports.create_slideshow = function create_slideshow(options, callback) {\n  options.resource_type = ensureOption(options, \"resource_type\", \"video\");\n  return call_api(\"create_slideshow\", callback, options, function () {\n    // Generate a transformation from the manifest_transformation key, which should be a valid transformation\n    var manifest_transformation = utils.generate_transformation_string(extend({}, options.manifest_transformation)); // Try to use {options.transformation} to generate a transformation (Example: options.transformation.width, options.transformation.height)\n\n    var transformation = utils.generate_transformation_string(extend({}, ensureOption(options, 'transformation', {})));\n    return [{\n      timestamp: utils.timestamp(),\n      manifest_transformation: manifest_transformation,\n      upload_preset: options.upload_preset,\n      overwrite: options.overwrite,\n      public_id: options.public_id,\n      notification_url: options.notification_url,\n      manifest_json: options.manifest_json,\n      tags: options.tags,\n      transformation: transformation\n    }];\n  });\n};\n\nexports.destroy = function destroy(public_id, callback) {\n  var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  return call_api(\"destroy\", callback, options, function () {\n    return [{\n      timestamp: utils.timestamp(),\n      type: options.type,\n      invalidate: options.invalidate,\n      public_id: public_id\n    }];\n  });\n};\n\nexports.rename = function rename(from_public_id, to_public_id, callback) {\n  var options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n  return call_api(\"rename\", callback, options, function () {\n    return [{\n      timestamp: utils.timestamp(),\n      type: options.type,\n      from_public_id: from_public_id,\n      to_public_id: to_public_id,\n      overwrite: options.overwrite,\n      invalidate: options.invalidate,\n      to_type: options.to_type\n    }];\n  });\n};\n\nvar TEXT_PARAMS = [\"public_id\", \"font_family\", \"font_size\", \"font_color\", \"text_align\", \"font_weight\", \"font_style\", \"background\", \"opacity\", \"text_decoration\", \"font_hinting\", \"font_antialiasing\"];\n\nexports.text = function text(content, callback) {\n  var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  return call_api(\"text\", callback, options, function () {\n    var textParams = pickOnlyExistingValues.apply(undefined, [options].concat(TEXT_PARAMS));\n\n    var params = _extends({\n      timestamp: utils.timestamp(),\n      text: content\n    }, textParams);\n\n    return [params];\n  });\n};\n/**\n * Generate a sprite by merging multiple images into a single large image for reducing network overhead and bypassing\n * download limitations.\n *\n * The process produces 2 files as follows:\n * - A single image file containing all the images with the specified tag (PNG by default).\n * - A CSS file that includes the style class names and the location of the individual images in the sprite.\n *\n * @param {String|Object} tag     A string specifying a tag that indicates which images to include or an object\n *                                which includes options and image URLs.\n * @param {Function}     callback   Callback function\n * @param {Object}       options  Configuration options. If options are passed as the first parameter, this parameter\n *                                should be empty\n *\n * @return {Object}\n */\n\n\nexports.generate_sprite = function generate_sprite(tag, callback) {\n  var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  return call_api(\"sprite\", callback, options, function () {\n    return [utils.build_multi_and_sprite_params(tag, options)];\n  });\n};\n/**\n * Returns a signed url to download a sprite\n *\n * @param {String|Object} tag     A string specifying a tag that indicates which images to include or an object\n *                                which includes options and image URLs.\n * @param {Object}       options  Configuration options. If options are passed as the first parameter, this parameter\n *                                should be empty\n *\n * @returns {string}\n */\n\n\nexports.download_generated_sprite = function download_generated_sprite(tag) {\n  var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  return utils.api_download_url(\"sprite\", utils.build_multi_and_sprite_params(tag, options), options);\n};\n/**\n * Returns a signed url to download a single animated image (GIF, PNG or WebP), video (MP4 or WebM) or a single PDF from\n * multiple image assets.\n *\n * @param {String|Object} tag     A string specifying a tag that indicates which images to include or an object\n *                                which includes options and image URLs.\n * @param {Object}       options  Configuration options. If options are passed as the first parameter, this parameter\n *                                should be empty\n *\n * @returns {string}\n */\n\n\nexports.download_multi = function download_multi(tag) {\n  var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  return utils.api_download_url(\"multi\", utils.build_multi_and_sprite_params(tag, options), options);\n};\n/**\n * Creates either a single animated image (GIF, PNG or WebP), video (MP4 or WebM) or a single PDF from multiple image\n * assets.\n *\n * Each asset is included as a single frame of the resulting animated image/video, or a page of the PDF (sorted\n * alphabetically by their Public ID).\n *\n * @param {String|Object} tag     A string specifying a tag that indicates which images to include or an object\n *                                which includes options and image URLs.\n * @param {Function}     callback   Callback function\n * @param {Object}       options  Configuration options. If options are passed as the first parameter, this parameter\n *                                should be empty\n *\n * @return {Object}\n */\n\n\nexports.multi = function multi(tag, callback) {\n  var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  return call_api(\"multi\", callback, options, function () {\n    return [utils.build_multi_and_sprite_params(tag, options)];\n  });\n};\n\nexports.explode = function explode(public_id, callback) {\n  var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  return call_api(\"explode\", callback, options, function () {\n    var transformation = utils.generate_transformation_string(extend({}, options));\n    return [{\n      timestamp: utils.timestamp(),\n      public_id: public_id,\n      transformation: transformation,\n      format: options.format,\n      type: options.type,\n      notification_url: options.notification_url\n    }];\n  });\n};\n/**\n *\n * @param {String}          tag                  The tag or tags to assign. Can specify multiple\n *                                               tags in a single string, separated by commas - \"t1,t2,t3,t4,t5,t6,t7,t8,t9,t10,t11\".\n *\n * @param {Array}          public_ids           A list of public IDs (up to 1000) of assets uploaded to Cloudinary.\n *\n * @param {Function}        callback             Callback function\n *\n * @param {Object}          options              Configuration options may include 'exclusive' (boolean) which causes\n *                                               clearing this tag from all other resources\n * @return {Object}\n */\n\n\nexports.add_tag = function add_tag(tag) {\n  var public_ids = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n  var callback = arguments[2];\n  var options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n  var exclusive = utils.option_consume(\"exclusive\", options);\n  var command = exclusive ? \"set_exclusive\" : \"add\";\n  return call_tags_api(tag, command, public_ids, callback, options);\n};\n/**\n * @param {String}          tag                  The tag or tags to remove. Can specify multiple\n *                                               tags in a single string, separated by commas - \"t1,t2,t3,t4,t5,t6,t7,t8,t9,t10,t11\".\n *\n * @param {Array}          public_ids            A list of public IDs (up to 1000) of assets uploaded to Cloudinary.\n *\n * @param {Function}        callback             Callback function\n *\n * @param {Object}          options              Configuration options may include 'exclusive' (boolean) which causes\n *                                               clearing this tag from all other resources\n * @return {Object}\n */\n\n\nexports.remove_tag = function remove_tag(tag) {\n  var public_ids = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n  var callback = arguments[2];\n  var options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n  return call_tags_api(tag, \"remove\", public_ids, callback, options);\n};\n\nexports.remove_all_tags = function remove_all_tags() {\n  var public_ids = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n  var callback = arguments[1];\n  var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  return call_tags_api(null, \"remove_all\", public_ids, callback, options);\n};\n\nexports.replace_tag = function replace_tag(tag) {\n  var public_ids = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n  var callback = arguments[2];\n  var options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n  return call_tags_api(tag, \"replace\", public_ids, callback, options);\n};\n\nfunction call_tags_api(tag, command) {\n  var public_ids = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : [];\n  var callback = arguments[3];\n  var options = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : {};\n  return call_api(\"tags\", callback, options, function () {\n    var params = {\n      timestamp: utils.timestamp(),\n      public_ids: utils.build_array(public_ids),\n      command: command,\n      type: options.type\n    };\n\n    if (tag != null) {\n      params.tag = tag;\n    }\n\n    return [params];\n  });\n}\n\nexports.add_context = function add_context(context) {\n  var public_ids = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n  var callback = arguments[2];\n  var options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n  return call_context_api(context, 'add', public_ids, callback, options);\n};\n\nexports.remove_all_context = function remove_all_context() {\n  var public_ids = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n  var callback = arguments[1];\n  var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  return call_context_api(null, 'remove_all', public_ids, callback, options);\n};\n\nfunction call_context_api(context, command) {\n  var public_ids = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : [];\n  var callback = arguments[3];\n  var options = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : {};\n  return call_api('context', callback, options, function () {\n    var params = {\n      timestamp: utils.timestamp(),\n      public_ids: utils.build_array(public_ids),\n      command: command,\n      type: options.type\n    };\n\n    if (context != null) {\n      params.context = utils.encode_context(context);\n    }\n\n    return [params];\n  });\n}\n/**\n * Cache (part of) the upload results.\n * @param result\n * @param {object} options\n * @param {string} options.type\n * @param {string} options.resource_type\n */\n\n\nfunction cacheResults(result, _ref) {\n  var type = _ref.type,\n      resource_type = _ref.resource_type;\n\n  if (result.responsive_breakpoints) {\n    result.responsive_breakpoints.forEach(function (_ref2) {\n      var transformation = _ref2.transformation,\n          url = _ref2.url,\n          breakpoints = _ref2.breakpoints;\n      return Cache.set(result.public_id, {\n        type,\n        resource_type,\n        raw_transformation: transformation,\n        format: extname(breakpoints[0].url).slice(1)\n      }, breakpoints.map(function (i) {\n        return i.width;\n      }));\n    });\n  }\n}\n\nfunction parseResult(buffer, res) {\n  var result = '';\n\n  try {\n    result = JSON.parse(buffer);\n\n    if (result.error && !result.error.name) {\n      result.error.name = \"Error\";\n    }\n  } catch (jsonError) {\n    result = {\n      error: {\n        message: `Server return invalid JSON response. Status Code ${res.statusCode}. ${jsonError}`,\n        name: \"Error\"\n      }\n    };\n  }\n\n  return result;\n}\n\nfunction call_api(action, callback, options, get_params) {\n  if (typeof callback !== \"function\") {\n    callback = function callback() {};\n  }\n\n  var USE_PROMISES = !options.disable_promises;\n  var deferred = Q.defer();\n\n  if (options == null) {\n    options = {};\n  }\n\n  var _get_params$call = get_params.call(),\n      _get_params$call2 = _slicedToArray(_get_params$call, 3),\n      params = _get_params$call2[0],\n      unsigned_params = _get_params$call2[1],\n      file = _get_params$call2[2];\n\n  params = utils.process_request_params(params, options);\n  params = extend(params, unsigned_params);\n  var api_url = utils.api_url(action, options);\n  var boundary = utils.random_public_id();\n  var errorRaised = false;\n\n  var handle_response = function handle_response(res) {\n    // let buffer;\n    if (errorRaised) {// Already reported\n    } else if (res.error) {\n      errorRaised = true;\n\n      if (USE_PROMISES) {\n        deferred.reject(res);\n      }\n\n      callback(res);\n    } else if (includes([200, 400, 401, 404, 420, 500], res.statusCode)) {\n      var buffer = \"\";\n      res.on(\"data\", function (d) {\n        buffer += d;\n        return buffer;\n      });\n      res.on(\"end\", function () {\n        var result = void 0;\n\n        if (errorRaised) {\n          return;\n        }\n\n        result = parseResult(buffer, res);\n\n        if (result.error) {\n          result.error.http_code = res.statusCode;\n\n          if (USE_PROMISES) {\n            deferred.reject(result.error);\n          }\n        } else {\n          cacheResults(result, options);\n\n          if (USE_PROMISES) {\n            deferred.resolve(result);\n          }\n        }\n\n        callback(result);\n      });\n      res.on(\"error\", function (error) {\n        errorRaised = true;\n\n        if (USE_PROMISES) {\n          deferred.reject(error);\n        }\n\n        callback({\n          error\n        });\n      });\n    } else {\n      var error = {\n        message: `Server returned unexpected status code - ${res.statusCode}`,\n        http_code: res.statusCode,\n        name: \"UnexpectedResponse\"\n      };\n\n      if (USE_PROMISES) {\n        deferred.reject(error);\n      }\n\n      callback({\n        error\n      });\n    }\n  };\n\n  var post_data = utils.hashToParameters(params).filter(function (_ref3) {\n    var _ref4 = _slicedToArray(_ref3, 2),\n        key = _ref4[0],\n        value = _ref4[1];\n\n    return value != null;\n  }).map(function (_ref5) {\n    var _ref6 = _slicedToArray(_ref5, 2),\n        key = _ref6[0],\n        value = _ref6[1];\n\n    return Buffer.from(encodeFieldPart(boundary, key, value), 'utf8');\n  });\n  var result = post(api_url, post_data, boundary, file, handle_response, options);\n\n  if (isObject(result)) {\n    return result;\n  }\n\n  if (USE_PROMISES) {\n    return deferred.promise;\n  }\n}\n\nfunction post(url, post_data, boundary, file, callback, options) {\n  var file_header = void 0;\n  var finish_buffer = Buffer.from(\"--\" + boundary + \"--\", 'ascii');\n  var oauth_token = options.oauth_token || config().oauth_token;\n\n  if (file != null || options.stream) {\n    // eslint-disable-next-line no-nested-ternary\n    var filename = options.stream ? options.filename ? options.filename : \"file\" : basename(file);\n    file_header = Buffer.from(encodeFilePart(boundary, 'application/octet-stream', 'file', filename), 'binary');\n  }\n\n  var post_options = urlLib.parse(url);\n  var headers = {\n    'Content-Type': `multipart/form-data; boundary=${boundary}`,\n    'User-Agent': utils.getUserAgent()\n  };\n\n  if (options.content_range != null) {\n    headers['Content-Range'] = options.content_range;\n  }\n\n  if (options.x_unique_upload_id != null) {\n    headers['X-Unique-Upload-Id'] = options.x_unique_upload_id;\n  }\n\n  if (oauth_token != null) {\n    headers.Authorization = `Bearer ${oauth_token}`;\n  }\n\n  post_options = extend(post_options, {\n    method: 'POST',\n    headers: headers\n  });\n\n  if (options.agent != null) {\n    post_options.agent = options.agent;\n  }\n\n  var proxy = options.api_proxy || config().api_proxy;\n\n  if (!isEmpty(proxy)) {\n    if (!post_options.agent) {\n      if (ProxyAgent === null) {\n        throw new Error(\"Proxy value is set, but `proxy-agent` is not installed, please install `proxy-agent` module.\");\n      }\n\n      post_options.agent = new ProxyAgent(proxy);\n    } else {\n      console.warn(\"Proxy is set, but request uses a custom agent, proxy is ignored.\");\n    }\n  }\n\n  var post_request = https.request(post_options, callback);\n  var upload_stream = new UploadStream({\n    boundary\n  });\n  upload_stream.pipe(post_request);\n  var timeout = false;\n  post_request.on(\"error\", function (error) {\n    if (timeout) {\n      error = {\n        message: \"Request Timeout\",\n        http_code: 499,\n        name: \"TimeoutError\"\n      };\n    }\n\n    return callback({\n      error\n    });\n  });\n  post_request.setTimeout(options.timeout != null ? options.timeout : 60000, function () {\n    timeout = true;\n    return post_request.abort();\n  });\n  post_data.forEach(function (postDatum) {\n    return post_request.write(postDatum);\n  });\n\n  if (options.stream) {\n    post_request.write(file_header);\n    return upload_stream;\n  }\n\n  if (file != null) {\n    post_request.write(file_header);\n    fs.createReadStream(file).on('error', function (error) {\n      callback({\n        error: error\n      });\n      return post_request.abort();\n    }).pipe(upload_stream);\n  } else {\n    post_request.write(finish_buffer);\n    post_request.end();\n  }\n\n  return true;\n}\n\nfunction encodeFieldPart(boundary, name, value) {\n  return [`--${boundary}`, `Content-Disposition: form-data; name=\"${name}\"`, '', value, ''].join(\"\\r\\n\");\n}\n\nfunction encodeFilePart(boundary, type, name, filename) {\n  return [`--${boundary}`, `Content-Disposition: form-data; name=\"${name}\"; filename=\"${filename}\"`, `Content-Type: ${type}`, '', ''].join(\"\\r\\n\");\n}\n\nexports.direct_upload = function direct_upload(callback_url) {\n  var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  var params = build_upload_params(extend({\n    callback: callback_url\n  }, options));\n  params = utils.process_request_params(params, options);\n  var api_url = utils.api_url(\"upload\", options);\n  return {\n    hidden_fields: params,\n    form_attrs: {\n      action: api_url,\n      method: \"POST\",\n      enctype: \"multipart/form-data\"\n    }\n  };\n};\n\nexports.upload_tag_params = function upload_tag_params() {\n  var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  var params = build_upload_params(options);\n  params = utils.process_request_params(params, options);\n  return JSON.stringify(params);\n};\n\nexports.upload_url = function upload_url() {\n  var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n  if (options.resource_type == null) {\n    options.resource_type = \"auto\";\n  }\n\n  return utils.api_url(\"upload\", options);\n};\n\nexports.image_upload_tag = function image_upload_tag(field) {\n  var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  var html_options = options.html || {};\n  var tag_options = extend({\n    type: \"file\",\n    name: \"file\",\n    \"data-url\": exports.upload_url(options),\n    \"data-form-data\": exports.upload_tag_params(options),\n    \"data-cloudinary-field\": field,\n    \"data-max-chunk-size\": options.chunk_size,\n    \"class\": [html_options.class, \"cloudinary-fileupload\"].join(\" \")\n  }, html_options);\n  return `<input ${utils.html_attrs(tag_options)}/>`;\n};\n\nexports.unsigned_image_upload_tag = function unsigned_image_upload_tag(field, upload_preset) {\n  var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  return exports.image_upload_tag(field, merge(options, {\n    unsigned: true,\n    upload_preset: upload_preset\n  }));\n};\n/**\n * Populates metadata fields with the given values. Existing values will be overwritten.\n *\n * @param {Object}   metadata   A list of custom metadata fields (by external_id) and the values to assign to each\n * @param {Array}    public_ids The public IDs of the resources to update\n * @param {Function} callback   Callback function\n * @param {Object}   options    Configuration options\n *\n * @return {Object}\n */\n\n\nexports.update_metadata = function update_metadata(metadata, public_ids, callback) {\n  var options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n  return call_api(\"metadata\", callback, options, function () {\n    var params = {\n      metadata: utils.encode_context(metadata),\n      public_ids: utils.build_array(public_ids),\n      timestamp: utils.timestamp(),\n      type: options.type\n    };\n    return [params];\n  });\n};","map":{"version":3,"names":["_slicedToArray","sliceIterator","arr","i","_arr","_n","_d","_e","undefined","_i","Symbol","iterator","_s","next","done","push","value","length","err","Array","isArray","Object","TypeError","_extends","assign","target","arguments","source","key","prototype","hasOwnProperty","call","_createClass","defineProperties","props","descriptor","enumerable","configurable","writable","defineProperty","Constructor","protoProps","staticProps","_classCallCheck","instance","_possibleConstructorReturn","self","ReferenceError","_inherits","subClass","superClass","create","constructor","setPrototypeOf","__proto__","fs","require","_require","extname","basename","Q","Writable","urlLib","_require2","upload_prefix","isSecure","slice","https","Cache","utils","UploadStream","config","ProxyAgent","optionalRequire","ensureOption","defaults","build_upload_params","extend","includes","isEmpty","isObject","isRemoteUrl","merge","pickOnlyExistingValues","exports","unsigned_upload_stream","upload_preset","callback","options","upload_stream","unsigned","upload","stream","unsigned_upload","file","call_api","params","upload_large","path","filename","split","pop","replace","upload_chunked","resource_type","file_reader","createReadStream","out_stream","upload_chunked_stream","pipe","Chunkable","_Writable","_this","getPrototypeOf","chunk_size","buffer","Buffer","alloc","active","on","emit","_write","data","encoding","_this2","concat","grab","upload_large_stream","_unused_","x_unique_upload_id","random_public_id","part_size","chunker","sent","is_last","chunk_start","content_range","timestamp","finished_part","result","errorOrLast","error","write","end","explicit","public_id","build_explicit_api_params","create_archive","target_format","opt","archive_params","create_zip","create_slideshow","manifest_transformation","generate_transformation_string","transformation","overwrite","notification_url","manifest_json","tags","destroy","type","invalidate","rename","from_public_id","to_public_id","to_type","TEXT_PARAMS","text","content","textParams","apply","generate_sprite","tag","build_multi_and_sprite_params","download_generated_sprite","api_download_url","download_multi","multi","explode","format","add_tag","public_ids","exclusive","option_consume","command","call_tags_api","remove_tag","remove_all_tags","replace_tag","build_array","add_context","context","call_context_api","remove_all_context","encode_context","cacheResults","_ref","responsive_breakpoints","forEach","_ref2","url","breakpoints","set","raw_transformation","map","width","parseResult","res","JSON","parse","name","jsonError","message","statusCode","action","get_params","USE_PROMISES","disable_promises","deferred","defer","_get_params$call","_get_params$call2","unsigned_params","process_request_params","api_url","boundary","errorRaised","handle_response","reject","d","http_code","resolve","post_data","hashToParameters","filter","_ref3","_ref4","_ref5","_ref6","from","encodeFieldPart","post","promise","file_header","finish_buffer","oauth_token","encodeFilePart","post_options","headers","getUserAgent","Authorization","method","agent","proxy","api_proxy","Error","console","warn","post_request","request","timeout","setTimeout","abort","postDatum","join","direct_upload","callback_url","hidden_fields","form_attrs","enctype","upload_tag_params","stringify","upload_url","image_upload_tag","field","html_options","html","tag_options","class","html_attrs","unsigned_image_upload_tag","update_metadata","metadata"],"sources":["/Users/abhinavkumar/Desktop/dbms/client/node_modules/cloudinary/lib-es5/uploader.js"],"sourcesContent":["'use strict';\n\nvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar fs = require('fs');\n\nvar _require = require('path'),\n    extname = _require.extname,\n    basename = _require.basename;\n\nvar Q = require('q');\nvar Writable = require(\"stream\").Writable;\nvar urlLib = require('url');\n\n// eslint-disable-next-line import/order\n\nvar _require2 = require(\"./config\")(),\n    upload_prefix = _require2.upload_prefix;\n\nvar isSecure = !(upload_prefix && upload_prefix.slice(0, 5) === 'http:');\nvar https = isSecure ? require('https') : require('http');\n\nvar Cache = require('./cache');\nvar utils = require(\"./utils\");\nvar UploadStream = require('./upload_stream');\nvar config = require(\"./config\");\nvar ProxyAgent = utils.optionalRequire('proxy-agent');\nvar ensureOption = require('./utils/ensureOption').defaults(config());\n\nvar build_upload_params = utils.build_upload_params,\n    extend = utils.extend,\n    includes = utils.includes,\n    isEmpty = utils.isEmpty,\n    isObject = utils.isObject,\n    isRemoteUrl = utils.isRemoteUrl,\n    merge = utils.merge,\n    pickOnlyExistingValues = utils.pickOnlyExistingValues;\n\n\nexports.unsigned_upload_stream = function unsigned_upload_stream(upload_preset, callback) {\n  var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n  return exports.upload_stream(callback, merge(options, {\n    unsigned: true,\n    upload_preset: upload_preset\n  }));\n};\n\nexports.upload_stream = function upload_stream(callback) {\n  var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n  return exports.upload(null, callback, extend({\n    stream: true\n  }, options));\n};\n\nexports.unsigned_upload = function unsigned_upload(file, upload_preset, callback) {\n  var options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n\n  return exports.upload(file, callback, merge(options, {\n    unsigned: true,\n    upload_preset: upload_preset\n  }));\n};\n\nexports.upload = function upload(file, callback) {\n  var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n  return call_api(\"upload\", callback, options, function () {\n    var params = build_upload_params(options);\n    return isRemoteUrl(file) ? [params, { file: file }] : [params, {}, file];\n  });\n};\n\nexports.upload_large = function upload_large(path, callback) {\n  var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n  if (path != null && isRemoteUrl(path)) {\n    // upload a remote file\n    return exports.upload(path, callback, options);\n  }\n  if (path != null && !options.filename) {\n    options.filename = path.split(/(\\\\|\\/)/g).pop().replace(/\\.[^/.]+$/, \"\");\n  }\n  return exports.upload_chunked(path, callback, extend({\n    resource_type: 'raw'\n  }, options));\n};\n\nexports.upload_chunked = function upload_chunked(path, callback, options) {\n  var file_reader = fs.createReadStream(path);\n  var out_stream = exports.upload_chunked_stream(callback, options);\n  return file_reader.pipe(out_stream);\n};\n\nvar Chunkable = function (_Writable) {\n  _inherits(Chunkable, _Writable);\n\n  function Chunkable(options) {\n    _classCallCheck(this, Chunkable);\n\n    var _this = _possibleConstructorReturn(this, (Chunkable.__proto__ || Object.getPrototypeOf(Chunkable)).call(this, options));\n\n    _this.chunk_size = options.chunk_size != null ? options.chunk_size : 20000000;\n    _this.buffer = Buffer.alloc(0);\n    _this.active = true;\n    _this.on('finish', function () {\n      if (_this.active) {\n        _this.emit('ready', _this.buffer, true, function () {});\n      }\n    });\n    return _this;\n  }\n\n  _createClass(Chunkable, [{\n    key: '_write',\n    value: function _write(data, encoding, done) {\n      var _this2 = this;\n\n      if (!this.active) {\n        done();\n      }\n      if (this.buffer.length + data.length <= this.chunk_size) {\n        this.buffer = Buffer.concat([this.buffer, data], this.buffer.length + data.length);\n        done();\n      } else {\n        var grab = this.chunk_size - this.buffer.length;\n        this.buffer = Buffer.concat([this.buffer, data.slice(0, grab)], this.buffer.length + grab);\n        this.emit('ready', this.buffer, false, function (active) {\n          _this2.active = active;\n          if (_this2.active) {\n            _this2.buffer = data.slice(grab);\n            done();\n          }\n        });\n      }\n    }\n  }]);\n\n  return Chunkable;\n}(Writable);\n\nexports.upload_large_stream = function upload_large_stream(_unused_, callback) {\n  var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n  return exports.upload_chunked_stream(callback, extend({\n    resource_type: 'raw'\n  }, options));\n};\n\nexports.upload_chunked_stream = function upload_chunked_stream(callback) {\n  var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n  options = extend({}, options, {\n    stream: true\n  });\n  options.x_unique_upload_id = utils.random_public_id();\n  var params = build_upload_params(options);\n  var chunk_size = options.chunk_size != null ? options.chunk_size : options.part_size;\n  var chunker = new Chunkable({\n    chunk_size: chunk_size\n  });\n  var sent = 0;\n  chunker.on('ready', function (buffer, is_last, done) {\n    var chunk_start = sent;\n    sent += buffer.length;\n    options.content_range = `bytes ${chunk_start}-${sent - 1}/${is_last ? sent : -1}`;\n    params.timestamp = utils.timestamp();\n    var finished_part = function finished_part(result) {\n      var errorOrLast = result.error != null || is_last;\n      if (errorOrLast && typeof callback === \"function\") {\n        callback(result);\n      }\n      return done(!errorOrLast);\n    };\n    var stream = call_api(\"upload\", finished_part, options, function () {\n      return [params, {}, buffer];\n    });\n    return stream.write(buffer, 'buffer', function () {\n      return stream.end();\n    });\n  });\n  return chunker;\n};\n\nexports.explicit = function explicit(public_id, callback) {\n  var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n  return call_api(\"explicit\", callback, options, function () {\n    return utils.build_explicit_api_params(public_id, options);\n  });\n};\n\n// Creates a new archive in the server and returns information in JSON format\nexports.create_archive = function create_archive(callback) {\n  var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  var target_format = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n\n  return call_api(\"generate_archive\", callback, options, function () {\n    var opt = utils.archive_params(options);\n    if (target_format) {\n      opt.target_format = target_format;\n    }\n    return [opt];\n  });\n};\n\n// Creates a new zip archive in the server and returns information in JSON format\nexports.create_zip = function create_zip(callback) {\n  var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n  return exports.create_archive(callback, options, \"zip\");\n};\n\nexports.create_slideshow = function create_slideshow(options, callback) {\n  options.resource_type = ensureOption(options, \"resource_type\", \"video\");\n  return call_api(\"create_slideshow\", callback, options, function () {\n    // Generate a transformation from the manifest_transformation key, which should be a valid transformation\n    var manifest_transformation = utils.generate_transformation_string(extend({}, options.manifest_transformation));\n\n    // Try to use {options.transformation} to generate a transformation (Example: options.transformation.width, options.transformation.height)\n    var transformation = utils.generate_transformation_string(extend({}, ensureOption(options, 'transformation', {})));\n\n    return [{\n      timestamp: utils.timestamp(),\n      manifest_transformation: manifest_transformation,\n      upload_preset: options.upload_preset,\n      overwrite: options.overwrite,\n      public_id: options.public_id,\n      notification_url: options.notification_url,\n      manifest_json: options.manifest_json,\n      tags: options.tags,\n      transformation: transformation\n    }];\n  });\n};\n\nexports.destroy = function destroy(public_id, callback) {\n  var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n  return call_api(\"destroy\", callback, options, function () {\n    return [{\n      timestamp: utils.timestamp(),\n      type: options.type,\n      invalidate: options.invalidate,\n      public_id: public_id\n    }];\n  });\n};\n\nexports.rename = function rename(from_public_id, to_public_id, callback) {\n  var options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n\n  return call_api(\"rename\", callback, options, function () {\n    return [{\n      timestamp: utils.timestamp(),\n      type: options.type,\n      from_public_id: from_public_id,\n      to_public_id: to_public_id,\n      overwrite: options.overwrite,\n      invalidate: options.invalidate,\n      to_type: options.to_type\n    }];\n  });\n};\n\nvar TEXT_PARAMS = [\"public_id\", \"font_family\", \"font_size\", \"font_color\", \"text_align\", \"font_weight\", \"font_style\", \"background\", \"opacity\", \"text_decoration\", \"font_hinting\", \"font_antialiasing\"];\n\nexports.text = function text(content, callback) {\n  var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n  return call_api(\"text\", callback, options, function () {\n    var textParams = pickOnlyExistingValues.apply(undefined, [options].concat(TEXT_PARAMS));\n    var params = _extends({\n      timestamp: utils.timestamp(),\n      text: content\n    }, textParams);\n\n    return [params];\n  });\n};\n\n/**\n * Generate a sprite by merging multiple images into a single large image for reducing network overhead and bypassing\n * download limitations.\n *\n * The process produces 2 files as follows:\n * - A single image file containing all the images with the specified tag (PNG by default).\n * - A CSS file that includes the style class names and the location of the individual images in the sprite.\n *\n * @param {String|Object} tag     A string specifying a tag that indicates which images to include or an object\n *                                which includes options and image URLs.\n * @param {Function}     callback   Callback function\n * @param {Object}       options  Configuration options. If options are passed as the first parameter, this parameter\n *                                should be empty\n *\n * @return {Object}\n */\nexports.generate_sprite = function generate_sprite(tag, callback) {\n  var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n  return call_api(\"sprite\", callback, options, function () {\n    return [utils.build_multi_and_sprite_params(tag, options)];\n  });\n};\n\n/**\n * Returns a signed url to download a sprite\n *\n * @param {String|Object} tag     A string specifying a tag that indicates which images to include or an object\n *                                which includes options and image URLs.\n * @param {Object}       options  Configuration options. If options are passed as the first parameter, this parameter\n *                                should be empty\n *\n * @returns {string}\n */\nexports.download_generated_sprite = function download_generated_sprite(tag) {\n  var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n  return utils.api_download_url(\"sprite\", utils.build_multi_and_sprite_params(tag, options), options);\n};\n\n/**\n * Returns a signed url to download a single animated image (GIF, PNG or WebP), video (MP4 or WebM) or a single PDF from\n * multiple image assets.\n *\n * @param {String|Object} tag     A string specifying a tag that indicates which images to include or an object\n *                                which includes options and image URLs.\n * @param {Object}       options  Configuration options. If options are passed as the first parameter, this parameter\n *                                should be empty\n *\n * @returns {string}\n */\nexports.download_multi = function download_multi(tag) {\n  var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n  return utils.api_download_url(\"multi\", utils.build_multi_and_sprite_params(tag, options), options);\n};\n\n/**\n * Creates either a single animated image (GIF, PNG or WebP), video (MP4 or WebM) or a single PDF from multiple image\n * assets.\n *\n * Each asset is included as a single frame of the resulting animated image/video, or a page of the PDF (sorted\n * alphabetically by their Public ID).\n *\n * @param {String|Object} tag     A string specifying a tag that indicates which images to include or an object\n *                                which includes options and image URLs.\n * @param {Function}     callback   Callback function\n * @param {Object}       options  Configuration options. If options are passed as the first parameter, this parameter\n *                                should be empty\n *\n * @return {Object}\n */\nexports.multi = function multi(tag, callback) {\n  var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n  return call_api(\"multi\", callback, options, function () {\n    return [utils.build_multi_and_sprite_params(tag, options)];\n  });\n};\n\nexports.explode = function explode(public_id, callback) {\n  var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n  return call_api(\"explode\", callback, options, function () {\n    var transformation = utils.generate_transformation_string(extend({}, options));\n    return [{\n      timestamp: utils.timestamp(),\n      public_id: public_id,\n      transformation: transformation,\n      format: options.format,\n      type: options.type,\n      notification_url: options.notification_url\n    }];\n  });\n};\n\n/**\n *\n * @param {String}          tag                  The tag or tags to assign. Can specify multiple\n *                                               tags in a single string, separated by commas - \"t1,t2,t3,t4,t5,t6,t7,t8,t9,t10,t11\".\n *\n * @param {Array}          public_ids           A list of public IDs (up to 1000) of assets uploaded to Cloudinary.\n *\n * @param {Function}        callback             Callback function\n *\n * @param {Object}          options              Configuration options may include 'exclusive' (boolean) which causes\n *                                               clearing this tag from all other resources\n * @return {Object}\n */\nexports.add_tag = function add_tag(tag) {\n  var public_ids = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n  var callback = arguments[2];\n  var options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n\n  var exclusive = utils.option_consume(\"exclusive\", options);\n  var command = exclusive ? \"set_exclusive\" : \"add\";\n  return call_tags_api(tag, command, public_ids, callback, options);\n};\n\n/**\n * @param {String}          tag                  The tag or tags to remove. Can specify multiple\n *                                               tags in a single string, separated by commas - \"t1,t2,t3,t4,t5,t6,t7,t8,t9,t10,t11\".\n *\n * @param {Array}          public_ids            A list of public IDs (up to 1000) of assets uploaded to Cloudinary.\n *\n * @param {Function}        callback             Callback function\n *\n * @param {Object}          options              Configuration options may include 'exclusive' (boolean) which causes\n *                                               clearing this tag from all other resources\n * @return {Object}\n */\nexports.remove_tag = function remove_tag(tag) {\n  var public_ids = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n  var callback = arguments[2];\n  var options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n\n  return call_tags_api(tag, \"remove\", public_ids, callback, options);\n};\n\nexports.remove_all_tags = function remove_all_tags() {\n  var public_ids = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n  var callback = arguments[1];\n  var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n  return call_tags_api(null, \"remove_all\", public_ids, callback, options);\n};\n\nexports.replace_tag = function replace_tag(tag) {\n  var public_ids = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n  var callback = arguments[2];\n  var options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n\n  return call_tags_api(tag, \"replace\", public_ids, callback, options);\n};\n\nfunction call_tags_api(tag, command) {\n  var public_ids = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : [];\n  var callback = arguments[3];\n  var options = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : {};\n\n  return call_api(\"tags\", callback, options, function () {\n    var params = {\n      timestamp: utils.timestamp(),\n      public_ids: utils.build_array(public_ids),\n      command: command,\n      type: options.type\n    };\n    if (tag != null) {\n      params.tag = tag;\n    }\n    return [params];\n  });\n}\n\nexports.add_context = function add_context(context) {\n  var public_ids = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n  var callback = arguments[2];\n  var options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n\n  return call_context_api(context, 'add', public_ids, callback, options);\n};\n\nexports.remove_all_context = function remove_all_context() {\n  var public_ids = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n  var callback = arguments[1];\n  var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n  return call_context_api(null, 'remove_all', public_ids, callback, options);\n};\n\nfunction call_context_api(context, command) {\n  var public_ids = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : [];\n  var callback = arguments[3];\n  var options = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : {};\n\n  return call_api('context', callback, options, function () {\n    var params = {\n      timestamp: utils.timestamp(),\n      public_ids: utils.build_array(public_ids),\n      command: command,\n      type: options.type\n    };\n    if (context != null) {\n      params.context = utils.encode_context(context);\n    }\n    return [params];\n  });\n}\n\n/**\n * Cache (part of) the upload results.\n * @param result\n * @param {object} options\n * @param {string} options.type\n * @param {string} options.resource_type\n */\nfunction cacheResults(result, _ref) {\n  var type = _ref.type,\n      resource_type = _ref.resource_type;\n\n  if (result.responsive_breakpoints) {\n    result.responsive_breakpoints.forEach(function (_ref2) {\n      var transformation = _ref2.transformation,\n          url = _ref2.url,\n          breakpoints = _ref2.breakpoints;\n      return Cache.set(result.public_id, { type, resource_type, raw_transformation: transformation, format: extname(breakpoints[0].url).slice(1) }, breakpoints.map(function (i) {\n        return i.width;\n      }));\n    });\n  }\n}\n\nfunction parseResult(buffer, res) {\n  var result = '';\n  try {\n    result = JSON.parse(buffer);\n    if (result.error && !result.error.name) {\n      result.error.name = \"Error\";\n    }\n  } catch (jsonError) {\n    result = {\n      error: {\n        message: `Server return invalid JSON response. Status Code ${res.statusCode}. ${jsonError}`,\n        name: \"Error\"\n      }\n    };\n  }\n  return result;\n}\n\nfunction call_api(action, callback, options, get_params) {\n  if (typeof callback !== \"function\") {\n    callback = function callback() {};\n  }\n\n  var USE_PROMISES = !options.disable_promises;\n\n  var deferred = Q.defer();\n  if (options == null) {\n    options = {};\n  }\n\n  var _get_params$call = get_params.call(),\n      _get_params$call2 = _slicedToArray(_get_params$call, 3),\n      params = _get_params$call2[0],\n      unsigned_params = _get_params$call2[1],\n      file = _get_params$call2[2];\n\n  params = utils.process_request_params(params, options);\n  params = extend(params, unsigned_params);\n  var api_url = utils.api_url(action, options);\n  var boundary = utils.random_public_id();\n  var errorRaised = false;\n  var handle_response = function handle_response(res) {\n    // let buffer;\n    if (errorRaised) {\n\n      // Already reported\n    } else if (res.error) {\n      errorRaised = true;\n\n      if (USE_PROMISES) {\n        deferred.reject(res);\n      }\n      callback(res);\n    } else if (includes([200, 400, 401, 404, 420, 500], res.statusCode)) {\n      var buffer = \"\";\n      res.on(\"data\", function (d) {\n        buffer += d;\n        return buffer;\n      });\n      res.on(\"end\", function () {\n        var result = void 0;\n        if (errorRaised) {\n          return;\n        }\n        result = parseResult(buffer, res);\n        if (result.error) {\n          result.error.http_code = res.statusCode;\n          if (USE_PROMISES) {\n            deferred.reject(result.error);\n          }\n        } else {\n          cacheResults(result, options);\n          if (USE_PROMISES) {\n            deferred.resolve(result);\n          }\n        }\n        callback(result);\n      });\n      res.on(\"error\", function (error) {\n        errorRaised = true;\n        if (USE_PROMISES) {\n          deferred.reject(error);\n        }\n        callback({ error });\n      });\n    } else {\n      var error = {\n        message: `Server returned unexpected status code - ${res.statusCode}`,\n        http_code: res.statusCode,\n        name: \"UnexpectedResponse\"\n      };\n      if (USE_PROMISES) {\n        deferred.reject(error);\n      }\n      callback({ error });\n    }\n  };\n  var post_data = utils.hashToParameters(params).filter(function (_ref3) {\n    var _ref4 = _slicedToArray(_ref3, 2),\n        key = _ref4[0],\n        value = _ref4[1];\n\n    return value != null;\n  }).map(function (_ref5) {\n    var _ref6 = _slicedToArray(_ref5, 2),\n        key = _ref6[0],\n        value = _ref6[1];\n\n    return Buffer.from(encodeFieldPart(boundary, key, value), 'utf8');\n  });\n  var result = post(api_url, post_data, boundary, file, handle_response, options);\n  if (isObject(result)) {\n    return result;\n  }\n\n  if (USE_PROMISES) {\n    return deferred.promise;\n  }\n}\n\nfunction post(url, post_data, boundary, file, callback, options) {\n  var file_header = void 0;\n  var finish_buffer = Buffer.from(\"--\" + boundary + \"--\", 'ascii');\n  var oauth_token = options.oauth_token || config().oauth_token;\n  if (file != null || options.stream) {\n    // eslint-disable-next-line no-nested-ternary\n    var filename = options.stream ? options.filename ? options.filename : \"file\" : basename(file);\n    file_header = Buffer.from(encodeFilePart(boundary, 'application/octet-stream', 'file', filename), 'binary');\n  }\n  var post_options = urlLib.parse(url);\n  var headers = {\n    'Content-Type': `multipart/form-data; boundary=${boundary}`,\n    'User-Agent': utils.getUserAgent()\n  };\n  if (options.content_range != null) {\n    headers['Content-Range'] = options.content_range;\n  }\n  if (options.x_unique_upload_id != null) {\n    headers['X-Unique-Upload-Id'] = options.x_unique_upload_id;\n  }\n  if (oauth_token != null) {\n    headers.Authorization = `Bearer ${oauth_token}`;\n  }\n\n  post_options = extend(post_options, {\n    method: 'POST',\n    headers: headers\n  });\n  if (options.agent != null) {\n    post_options.agent = options.agent;\n  }\n  var proxy = options.api_proxy || config().api_proxy;\n  if (!isEmpty(proxy)) {\n    if (!post_options.agent) {\n      if (ProxyAgent === null) {\n        throw new Error(\"Proxy value is set, but `proxy-agent` is not installed, please install `proxy-agent` module.\");\n      }\n      post_options.agent = new ProxyAgent(proxy);\n    } else {\n      console.warn(\"Proxy is set, but request uses a custom agent, proxy is ignored.\");\n    }\n  }\n\n  var post_request = https.request(post_options, callback);\n  var upload_stream = new UploadStream({ boundary });\n  upload_stream.pipe(post_request);\n  var timeout = false;\n  post_request.on(\"error\", function (error) {\n    if (timeout) {\n      error = {\n        message: \"Request Timeout\",\n        http_code: 499,\n        name: \"TimeoutError\"\n      };\n    }\n    return callback({ error });\n  });\n  post_request.setTimeout(options.timeout != null ? options.timeout : 60000, function () {\n    timeout = true;\n    return post_request.abort();\n  });\n  post_data.forEach(function (postDatum) {\n    return post_request.write(postDatum);\n  });\n  if (options.stream) {\n    post_request.write(file_header);\n    return upload_stream;\n  }\n  if (file != null) {\n    post_request.write(file_header);\n    fs.createReadStream(file).on('error', function (error) {\n      callback({\n        error: error\n      });\n      return post_request.abort();\n    }).pipe(upload_stream);\n  } else {\n    post_request.write(finish_buffer);\n    post_request.end();\n  }\n  return true;\n}\n\nfunction encodeFieldPart(boundary, name, value) {\n  return [`--${boundary}`, `Content-Disposition: form-data; name=\"${name}\"`, '', value, ''].join(\"\\r\\n\");\n}\n\nfunction encodeFilePart(boundary, type, name, filename) {\n  return [`--${boundary}`, `Content-Disposition: form-data; name=\"${name}\"; filename=\"${filename}\"`, `Content-Type: ${type}`, '', ''].join(\"\\r\\n\");\n}\n\nexports.direct_upload = function direct_upload(callback_url) {\n  var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n  var params = build_upload_params(extend({\n    callback: callback_url\n  }, options));\n  params = utils.process_request_params(params, options);\n  var api_url = utils.api_url(\"upload\", options);\n  return {\n    hidden_fields: params,\n    form_attrs: {\n      action: api_url,\n      method: \"POST\",\n      enctype: \"multipart/form-data\"\n    }\n  };\n};\n\nexports.upload_tag_params = function upload_tag_params() {\n  var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n  var params = build_upload_params(options);\n  params = utils.process_request_params(params, options);\n  return JSON.stringify(params);\n};\n\nexports.upload_url = function upload_url() {\n  var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n  if (options.resource_type == null) {\n    options.resource_type = \"auto\";\n  }\n  return utils.api_url(\"upload\", options);\n};\n\nexports.image_upload_tag = function image_upload_tag(field) {\n  var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n  var html_options = options.html || {};\n  var tag_options = extend({\n    type: \"file\",\n    name: \"file\",\n    \"data-url\": exports.upload_url(options),\n    \"data-form-data\": exports.upload_tag_params(options),\n    \"data-cloudinary-field\": field,\n    \"data-max-chunk-size\": options.chunk_size,\n    \"class\": [html_options.class, \"cloudinary-fileupload\"].join(\" \")\n  }, html_options);\n  return `<input ${utils.html_attrs(tag_options)}/>`;\n};\n\nexports.unsigned_image_upload_tag = function unsigned_image_upload_tag(field, upload_preset) {\n  var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n  return exports.image_upload_tag(field, merge(options, {\n    unsigned: true,\n    upload_preset: upload_preset\n  }));\n};\n\n/**\n * Populates metadata fields with the given values. Existing values will be overwritten.\n *\n * @param {Object}   metadata   A list of custom metadata fields (by external_id) and the values to assign to each\n * @param {Array}    public_ids The public IDs of the resources to update\n * @param {Function} callback   Callback function\n * @param {Object}   options    Configuration options\n *\n * @return {Object}\n */\nexports.update_metadata = function update_metadata(metadata, public_ids, callback) {\n  var options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n\n  return call_api(\"metadata\", callback, options, function () {\n    var params = {\n      metadata: utils.encode_context(metadata),\n      public_ids: utils.build_array(public_ids),\n      timestamp: utils.timestamp(),\n      type: options.type\n    };\n    return [params];\n  });\n};"],"mappings":"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"},"metadata":{},"sourceType":"script"}